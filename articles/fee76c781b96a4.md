---
title: "ã€Next.jsã€‘ã‚µãƒƒã‚«ãƒ¼é¸æ‰‹ã®æˆç¸¾ã‚’åˆ†æã™ã‚‹ãŸã‚ã®æº–å‚™"
emoji: "ğŸƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Next.js", "TypeScript", "axios"]
published: true
---

# ã¯ã˜ã‚ã«
ã‚µãƒƒã‚«ãƒ¼é¸æ‰‹ã®è©¦åˆæˆç¸¾ã‚’åˆ†æã—ãŸã„

# æœ¬è¨˜äº‹ã§èª¬æ˜ã™ã‚‹å†…å®¹
ãƒ‡ãƒ¼ã‚¿åˆ†æç”¨ã«ä»¥ä¸‹é …ç›®ã‚’å®Ÿæ–½
- ãƒ‡ãƒ¼ã‚¿åŸºç›¤æ•´ç†
- UI è¨­è¨ˆ
- CSV å‡ºåŠ›
- åˆ†æãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

# API ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹
ä»Šå›ã¯ãƒãƒ³ãƒã‚§ã‚¹ã‚¿ãƒ¼ãƒ»ã‚·ãƒ†ã‚£ã®é¸æ‰‹ã‚’å¯¾è±¡ã¨ã—ã¾ã™ã€‚

## ä½¿ç”¨ã™ã‚‹ API
ä»Šå›ä½¿ç”¨ã™ã‚‹ API ã¯ã“ã¡ã‚‰ã§ã™ã€‚

https://www.api-football.com/

ã“ã® API ã§å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¯æ§˜ã€…ã§ã™ã®ã§ã€ç›®çš„ã«å¿œã˜ã¦ä¸‹è¨˜ãƒšãƒ¼ã‚¸ã§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å¤‰ãˆã¦ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ã¡ãªã¿ã«ã€ã“ã®ãƒšãƒ¼ã‚¸ã§è‡ªåˆ†ã® API_KEY ã‚’å–å¾—ã§ãã¾ã™ã€‚

https://dashboard.api-football.com/soccer/tester

## ä½•ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æŒã¤ã®ã‹
ã¾ãšã¯ãƒ‡ãƒ¢ã¨ã—ã¦ã€ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚
- Nameï¼šåå‰
- Ageï¼šå¹´é½¢
- Game (min)ï¼šå‡ºå ´è©¦åˆæ•°ï¼ˆåˆ†ï¼‰
- Goal (shots)ï¼šã‚´ãƒ¼ãƒ«æ•°ï¼ˆæ±ºå®šæ©Ÿã‚·ãƒ¥ãƒ¼ãƒˆæœ¬æ•°ï¼‰
- Assist (pass)ï¼šã‚¢ã‚·ã‚¹ãƒˆæ•°ï¼ˆæ±ºå®šæ©Ÿãƒ‘ã‚¹æœ¬æ•°ï¼‰

â€»ä»Šå¾Œåˆ†æã—ãŸã„ç›®çš„ã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿åŸºç›¤ã¯ãã®éƒ½åº¦æ•´ç†ã—ã¾ã™ã€‚

## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹å®šç¾©
API ã§å–å¾—ã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹å®šç¾©ã¯ types ã§ã¯ãªã api ãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã§è¡Œã„ã¾ã™ã€‚

ã‚‚ã¡ã‚ã‚“ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã‚ˆã£ã¦å‹ãŒç•°ãªã‚‹ã®ã§ãã®éš›ã¯æ–°ã—ãå—ã‘çš¿ã‚’ä½œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
:::details APIã®å‹å®šç¾©
```ts: src/types/api/player.ts
export type Player = {
  player: {
    id: number;
    name: string;
    firstname: string;
    lastname: string;
    age: number;
    birth: {
      date: string;
      place: string;
      country: string;
    };
    nationality: string;
    height: string;
    weight: string;
    injured: boolean;
    photo: string;
  }
  statistics: {
    team: {
      id: number;
      name: string;
      logo: string;
    },
    league: {
      id: number;
      name: string;
      country: string;
      logo: string;
      flag: string;
      season: number;
    },
    games: {
      appearences: number;
      lineups: number;
      minutes: number;
      number: number;
      position: string;
      rating: number;
      captain: boolean;
    },
    substitutes: {
      in: number;
      out: number;
      bench: number;
    },
    shots: {
      total: number;
      on: number;
    },
    goals: {
      total: number;
      conceded: number;
      assists: number;
      saves: number;
    },
    passes: {
      total: number;
      key: number;
      accuracy: number;
    },
    tackles: {
      total: number;
      blocks: number;
      interceptions: number;
    },
    duels: {
      total: number;
      won: number;
    },
    dribbles: {
      attempts: number;
      success: number;
      past: number;
    },
    fouls: {
      drawn: number;
      committed: number;
    },
    cards: {
      yellow: number;
      yellowred: number;
      red: number;
    },
    penalty: {
      won: number;
      commited: number;
      scored: number;
      missed: number;
      saved: number;
    },

  }
};
```
:::

## ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œã‚‹
axios ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ã„ã€API ã®æŒ‡å®šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å©ãã€é¸æ‰‹ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚
:::details APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
```ts: src/hooks/useGetPlayers.ts
import axios from "axios";
import { useState } from "react";
import { Player } from "../types/api/player";

//ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ãƒãƒ³ãƒã‚§ã‚¹ã‚¿ãƒ¼ã‚·ãƒ†ã‚£ã®é¸æ‰‹ã‚¹ã‚¿ãƒƒãƒ„ã‚’å–å¾—
export const useGetPlayers = () => {
  const [player, setPlayer] = useState<Array<Player>>([]);
  const [playerNext, setPlayerNext] = useState<Array<Player>>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(false);

  const getPlayers = () => {
    setLoading(true);
    setError(false);
    axios
      .get("https://v3.football.api-sports.io/players?league=39&season=2021&team=50", {
        "method": "GET",
        "headers": {
            "x-rapidapi-host": "v3.football.api-sports.io",
            "x-rapidapi-key": "" //API_KEYã‚’ã“ã¡ã‚‰ã«ã‚»ãƒƒãƒˆã—ã¾ã™
        }
      })
      .then((res) => {
        const playersLists = res.data?.response
        setPlayer(playersLists);
      })
      .catch(() => {
        setError(true); //ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ
      })
      .finally(() => {
        setLoading(false); //æ­£å¸¸çµ‚äº†
      });
  };

  return { getPlayers, getPlayersNext, player, playerNext, loading, error };
};
```
:::

# UI ã«åæ˜ ã™ã‚‹
ä½¿ç”¨ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
:::details ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
```tsx: src/components/templates/players/index.tsx
import React from 'react';
import { Player } from '../../../types/api/player';
import Table from '@mui/material/Table';
import TableBody from '@mui/material/TableBody';
import TableCell from '@mui/material/TableCell';
import TableContainer from '@mui/material/TableContainer';
import TableHead from '@mui/material/TableHead';
import TableRow from '@mui/material/TableRow';
import Paper from '@mui/material/Paper';

export interface playerProps {
  players: Player[]
}

//å®Ÿéš›ã«ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã®å®šç¾©
export const PlayerCard: React.FC<playerProps> = ({players}) => {
  return (
    <TableContainer component={Paper}>
      <Table sx={{ minWidth: 600 }} aria-label="simple table">
        <TableHead>
          <TableRow>
            <TableCell align="center">Name</TableCell>
            <TableCell align="center">Age</TableCell>
            <TableCell align="center">Game&nbsp;(min)</TableCell>
            <TableCell align="center">Goal&nbsp;(shots)</TableCell>
            <TableCell align="center">Assist&nbsp;(pass)</TableCell>
          </TableRow>
        </TableHead>
        <TableBody>
          {players.map((player) => (
            <TableRow
              key={player.player.id}
              sx={{ '&:last-child td, &:last-child th': { border: 0 } }}
            >
              <TableCell component="th" scope="row" align="left">{player.player.firstname}</TableCell>
              <TableCell align="left">{player.player.age}</TableCell>
              <TableCell align="left">{player.statistics[0]?.games?.appearences}&nbsp;({player.statistics[0]?.games?.minutes})</TableCell>
              <TableCell align="left">{player.statistics[0]?.goals?.total}&nbsp;({player.statistics[0]?.shots?.total})</TableCell>
              <TableCell align="left">{player.statistics[0]?.goals?.assists}&nbsp;({player.statistics[0]?.passes?.key})</TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </TableContainer>
  );
};
export default React.memo(PlayerCard);
```
:::

ãƒ•ãƒ­ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã«åæ˜ ã—ã¾ã™
:::details useEffectã§ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’å‘¼ã³å‡ºã™
```tsx: src/pages/player/index.tsx
import React, { useEffect } from 'react';
import Head from 'next/head'
import Layout, { siteTitle } from '../../components/templates/layout/layout'
import Link from 'next/link';
import { Button } from '@mui/material';
import { useGetPlayers } from '../../hooks/useGetPlayers';
import { PlayerCard } from '../../components/templates/players';

const PlayerPage: React.FC = () => {
  const { getPlayers, getPlayersNext, player, playerNext, loading, error} = useGetPlayers();

  //useEffectã§ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’å‘¼ã³å‡ºã™
  useEffect(()=>{
    getPlayers();
  },[])
    return (
    <Layout home>
      <Head>
        <title>{siteTitle}</title>
      </Head>
      <Link href='/'><Button>Home</Button></Link>
      <section>
      <br />
      {error ? (
        <p>ãƒ‡ãƒ¼ã‚¿å–å¾—ã«å¤±æ•—ã—ã¦ã„ã¾ã™</p>
      ) : loading ? (
        <p>Loading...</p>
      ) : (
        <>
        <PlayerCard players={playerLists}/>
        </>
      )}
      </section>
    </Layout>
  )
};
export default React.memo(PlayerPage);
```
:::

# CSV å‡ºåŠ›
ç”»é¢è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ CSV å‡ºåŠ›ã—ã¾ã™ã€‚

è£å´ã§æŒã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’UIã«å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€è¡¨ç¤ºã›ãšã¨ã‚‚å‡ºåŠ›ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã™ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã¦ã„ãã¨ã‚€ã—ã‚è¦‹æ „ãˆãŒæ‚ªããªã‚‹ã®ã§ãã“ã¯ãŠå¥½ã¿ã§å®Ÿè£…ã—ã¾ã™ã€‚

:::details CSVå‡ºåŠ›é–¢æ•°
```tsx: src/pages/player/index.tsx
  //CSVå‡ºåŠ›é–¢æ•°ã‚’å®šç¾©
  const handleClickCsvDownloadBtn = async (
    format: "xlsx" | "csv",
    charcode?: "UTF8" | "SJIS"
  ) => {

    const workbook = new ExcelJS.Workbook();
    workbook.addWorksheet("sheet1");
    const worksheet = workbook.getWorksheet("sheet1");

    worksheet.columns = [
      { header: "Name", key: "id" },
      { header: "Age", key: "age" },
      { header: "Game", key: "game" },
      { header: "Goal", key: "goal" },
      { header: "Assist", key: "assist" },
    ];

    // å–å¾—ã—ãŸé¸æ‰‹æƒ…å ±ã‚’å…¨ã¦å‡ºåŠ›ã™ã‚‹ãƒ«ãƒ¼ãƒ—åˆ†
    for (let i = 0; i < playerLists?.length; i++) {
      worksheet.addRows([
        {
          id: playerLists[i].player.name,
          age: playerLists[i].player.age,
          game: playerLists[i].statistics.games?.appearences,
          goal: playerLists[i].statistics.goals?.total,
          assist: playerLists[i].statistics.goals?.assists
        },
      ]);
    }

    //æ–‡å­—åŒ–ã‘ã—ãªã„ã‚ˆã†ã«SJISæŒ‡å®šã™ã‚‹ã€ã¾ã‚utf8ã§ã‚‚è‰¯ã„
    const uint8Array =
      format === "xlsx"
        ? await workbook.xlsx.writeBuffer()
        : charcode === "UTF8"
        ? await workbook.csv.writeBuffer()
        : new Uint8Array(
            encoding.convert(await workbook.csv.writeBuffer(), {
              from: "UTF8",
              to: "SJIS"
            })
          );
    const blob = new Blob([uint8Array], {
      type: "application/octet-binary"
    });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "sampleData." + format;
    a.click();
    a.remove();
  };
```
:::
# åˆ†æãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å›ã™
ä¸‹è¨˜ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ã„é¸æ‰‹ã‚¹ã‚¿ãƒƒãƒ„ã®åˆ†æãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’è¡Œã„ã¾ã™ã€‚
https://github.com/mckayjohns/Viz-Templates

## å€‹äººé¸æ‰‹ã®ã‚¹ã‚­ãƒ«æ¯”è¼ƒ
ã“ã¡ã‚‰ã®ã‚½ãƒ¼ã‚¹ã¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã„ã¾ã™ã€‚
https://github.com/mckayjohns/Viz-Templates/blob/master/code/Radars%20Tutorial.ipynb
https://github.com/mckayjohns/Viz-Templates/blob/master/data/radars.csv

ãƒ•ãƒ­ãƒ¼ã¨ã—ã¦ã¯ã€CSVã§èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ã®ã†ã¡åå‰ã‚’ã‚­ãƒ¼ã«ã—ãŸã„ãŸã‚æ–‡å­—åˆ—ã‚’æ•´ç†ã—ã€æŠ½å‡ºã—ãŸã„ãƒ‡ãƒ¼ã‚¿ä»¥å¤–ã®ã‚«ãƒ©ãƒ ã‚’æ’é™¤ã—ã€å–å¾—ã—ãŸå¯¾è±¡ã®æ•°å€¤ã‚’Raderãƒãƒ£ãƒ¼ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å‰²ã‚Šå½“ã¦ã¦ã„ãã¨ã„ã†æµã‚Œã§ã™ã€‚

è©¦ã—ã«ã€ã‚¸ãƒ§ã‚¢ãƒ³ã‚«ãƒ³ã‚»ãƒ­ã¨ãƒˆãƒ¬ãƒ³ãƒˆã‚¢ãƒ¬ã‚¯ã‚µãƒ³ãƒ€ãƒ¼ã‚¢ãƒ¼ãƒãƒ«ãƒ‰ã®ã‚¹ã‚¿ãƒƒãƒ„æ¯”è¼ƒã‚’è¡Œã£ãŸçµæœã§ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/f63a2333edf6-20220605.png)


ã“ã¡ã‚‰ã‚‚å‚è€ƒã«ãªã‚Šãã†ã§ã™ã€‚
https://github.com/Slothfulwave612/soccerplots/blob/master/docs/radar_chart.md

# ãŠã‚ã‚Šã«
åˆ†æå¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã€ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«å¾“ã„ã‚µãƒƒã‚«ãƒ¼é¸æ‰‹ã®è©¦åˆæˆç¸¾ã‚¹ã‚¿ãƒƒãƒ„ã‚’åˆ†æã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

ä»Šå¾Œã¯ç§»ç±ãƒãƒ¼ã‚±ãƒƒãƒˆå¸‚å ´ãŒç››ã‚Šä¸ŠãŒã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚„å¤§ããªå¤§ä¼šï¼ˆãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—ã‚„æ¬§å·ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³ã‚ºãƒªãƒ¼ã‚°ï¼‰å‰ã«é¢ç™½ãã†ãªãƒ‡ãƒ¼ã‚¿åˆ†æçµæœã‚’ã‚µãƒƒã‚«ãƒ¼ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å†…ã§ç™ºä¿¡ã—ã¦åå¿œã‚’æ¥½ã—ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

æœ€å¾Œã¾ã§ãŠèª­ã¿ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚