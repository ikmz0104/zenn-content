---
title: "ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½œæˆã—ã¦ã¿ãŸ"
emoji: "ğŸ•"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Blockchain", "Bitcoin", "Python"]
published: false
---

# ã¯ã˜ã‚ã«
ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã¨ã¯ç°¡å˜ã«ã„ã†ã¨ã€Œä¸­å¤®é›†æ¨©è€…ã‚’åª’ä»‹ã›ãšç´ æ—©ãé€šè²¨ã‚’é€é‡‘ã™ã‚‹ã€ãŸã‚ã®æš—å·é€šè²¨ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

æš—å·é€šè²¨ã‚’å®‰å…¨ã«ä¿ç®¡ã™ã‚‹ãŸã‚ã«ã¯ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã‚’ç”¨ã„ã¾ã™ã€‚

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã®ç«‹ã¡ä½ç½®ã¨ã—ã¦ã¯ã€Œè²¡å¸ƒã€ã¨ã„ã†ã‚ˆã‚Šã€Œç§˜å¯†éµã®ä¿ç®¡å ´æ‰€ã€ã¨ãªã‚Šã¾ã™ã€‚

æš—å·é€šè²¨ã®å–å¼•ãŒç™ºç”Ÿã™ã‚‹éš›ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ç½²åã¨æ¤œè¨¼ãŒè¡Œã‚ã‚Œã‚‹ã®ã§ã™ãŒãã®éš›ã«ç§˜å¯†éµãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

æš—å·é€šè²¨ã®å–å¼•ï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã€ä¾‹ãˆã°ã‚¢ãƒªã‚¹ã•ã‚“ãŒãƒœãƒ–ã•ã‚“ã«`1 BTC`é€é‡‘ã™ã‚‹éš›ã«å¿…è¦ãªã®ãŒä¸¡è€…ã®ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã§ã™ã€‚

## ç’°å¢ƒ
WSL2

Ubuntu 20.04 on Windows(11)

## å®Ÿè£…æ–¹é‡
- ç§˜å¯†éµã‚’ä½œã‚‹
- å…¬é–‹éµã‚’ä½œã‚‹
- ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½œã‚‹

##ã€€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
åˆ©ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
```py: main.py
import secrets
import ecdsa
import hashlib
import base58
```
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ
```
sudo apt install python3-pip
sudo pip install ecdsa
sudo pip install base58
```

å¤§æ ã®ã‚½ãƒ¼ã‚¹
```py: main.py
# ä¸»ã‚³ãƒ¼ãƒ‰
class generateWalletAddress():
    def __init__(self):
      p = 2**256-2**32-2**9-2**8-2**7-2**6-2**4-1
      privateKey = self.getPrivatekey(p)
      publicKey = self.getPublickey(privateKey)
      walletAddress = self.getWalletAddress(bytes.fromhex("00"), publicKey)

    def getPrivatekey(self, p):
    def getPublickey(self, privateKey):
    def getWalletAddress(self, version, publicKey):

# WAã‚’ä½œæˆã™ã‚‹ã«å½“ãŸã‚Šé–¢æ•°ã‚’å‘¼ã³å‡ºã™
walletAddress = generateWalletAddress()
```

# ç§˜å¯†éµã‚’ä½œã‚‹
ç§˜å¯†éµã¨ã¯1ï½2^256ã¾ã§ã®æ•´æ•°å€¤ã§ã™ã€‚

2**256 ã‚ˆã‚Šå¾®å°ãªæ•°å€¤ã‚’p(= 2**256-2**32-2**9-2**8-2**7-2**6-2**4-1)ã¨å®šç¾©ã—ã¾ã™ã€‚

[secrets.randbelow(n)](https://docs.python.org/ja/3/library/secrets.html)ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã«pã‚’æ¸¡ã—ã¦ã€ãƒ©ãƒ³ãƒ€ãƒ ãªæ•´æ•°ã‚’å–å¾—ã—ç§˜å¯†éµã‚’ç”Ÿæˆã—ã¾ã™ã€‚

```py: main.py
def getPrivatekey(self, p):
    # ç§˜å¯†éµã¯pã‚ˆã‚Šå°ã•ãªæ•°å­—ã‚’é¸æŠã™ã‚‹
    privateKey = secrets.randbelow(p)
    # 16é€²æ•°è¡¨ç¤ºã«å¤‰æ›
    privateKey = format(privateKey, 'x')
    print("ç§˜å¯†éµãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸï¼š" + privateKey)
    return privateKey
```

# å…¬é–‹éµã‚’ä½œã‚‹
ä½œæˆã—ãŸç§˜å¯†éµã¨[ECDSA](https://zenn.dev/mizuneko4345/articles/6f9837967d2ed1)ã‚’ç”¨ã„ã¦å…¬é–‹éµã‚’ç”Ÿæˆã—ã¾ã™ã€‚
```py: main.py
def getPublickey(self, privateKey):
    # 16é€²æ•°ã‹ã‚‰ãƒã‚¤ãƒˆåˆ—ã«å¤‰æ›
    bin_privateKey = bytes.fromhex(privateKey)
    # ECDSAã‚’ç”¨ã„ã¦æ¥•å††æ›²ç·šã‹ã‚‰å…¬é–‹éµã¨ãªã‚‹å€¤ã‚’è¨ˆç®—
    signing_key = ecdsa.SigningKey.from_string(bin_privateKey, curve = ecdsa.SECP256k1) # ãƒ¡ã‚½ãƒƒãƒ‰ã®æŒ‡å®š
    verifying_key = signing_key.get_verifying_key()
    # æ–‡å­—åˆ—ã®æ“ä½œ
    publicKey = bytes.fromhex("04") + verifying_key.to_string()
    publicKey = publicKey.hex()
    print("å…¬é–‹éµãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸï¼š" + publicKey)
    return publicKey
```

# ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½œã‚‹
```py: main.py
def getWalletAddress(self, version, publicKey):
    ba = bytes.fromhex(publicKey)
    # sha256ã§ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦ã§ããŸã‚‚ã®ã‚’æ–‡å­—åˆ—å¤‰æ›
    digest = hashlib.sha256(ba).digest()
    new_digest = hashlib.new('ripemd160')
    new_digest.update(digest)
    publicKey_hash = new_digest.digest()

    pre_address = version + publicKey_hash
    address = hashlib.sha256(pre_address).digest()
    address = hashlib.sha256(address).digest()
    checksum = address[:4]
    address = pre_address + checksum
    # bitocoinç‰¹æœ‰ã†ã®ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
    address = base58.b58encode(address)
    address = address.decode()
    print("Address = " + address + "\n")
    return address
```

# ãŠã¾ã‘
ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ãŒä»®æƒ³é€šè²¨ã®é€å—ä¿¡ã«æ³¨ç›®ã—ãŸæš—å·é€šè²¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚ã‚‹ä¸€æ–¹ã§ã€
ã‚¤ãƒ¼ã‚µãƒªã‚¢ãƒ ã¯æš—å·é€šè²¨ã§ã¯ãªãã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã§å‹•ã‹ã™ã“ã¨ã«æ³¨ç›®ã—ãŸãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã®å¯¾æ”¹ç«„æ€§ã«ç€ç›®ã™ã‚‹ã¨æš—å·é€šè²¨ã®å–å¼•ä»¥å¤–ã«ã‚‚æ¨©åˆ©é–¢ä¿‚ã®ç§»å‹•ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã«æ›¸ãè¾¼ã‚€ã“ã¨ã§ã‚‚ã£ã¨æ±ç”¨æ€§ã®ã‚ã‚‹ä»•çµ„ã¿ãŒã§ãã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†æ„å‘ã§ã™ã€ã¤ã¾ã‚Šã‚¢ã‚«ã‚¦ãƒ³ãƒˆæŒ‡å‘å‹ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨è¨€ãˆã¾ã™ã€‚

ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã¯å¥‘ç´„æƒ…å ±ï¼ˆæ¨©åˆ©ã®è¨¼æ˜ã‚„æ¨©åˆ©ã®ç§»å‹•ï¼‰ã‚’è‡ªå‹•çš„ã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã«æ›¸ãè¾¼ã‚€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

ä¸é€æ˜æ€§ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’æ‹…ä¿ã™ã‚‹ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³æŠ€è¡“ãŒã‚‚ã£ã¨å¤šæ§˜ãªã‚·ã‚¹ãƒ†ãƒ ã«å–ã‚Šå…¥ã‚Œã‚‰ã‚Œã‚‹ä¸–ã®ä¸­ã«ãªã£ã¦ã„ãã“ã¨ãŒæ¥½ã—ã¿ã§ã™ã­ã€‚

# å‚è€ƒè¨˜äº‹
https://qiita.com/kaz1shuu2/items/921dcbebb7fbea14f085
https://nevertoolate.hatenablog.jp/entry/2020/04/02/060000

# ãŠã‚ã‚Šã«
å®Ÿã¯ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã®ã‚„ã‚Šå–ã‚Šã‚’ã—ãŸã“ã¨ãŒã‚ã‚Šã¾ã›ã‚“ãŒã€æ™®æ®µä½•æ°—ãªããƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã§ETHã‚„MATICã®ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹éš›ã«ãƒãƒ³ãƒãƒ³ã¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ä»Šä¸€åº¦ç†è§£ã‚’é€²ã‚ã‚ˆã†ã¨ä»Šå›è¨˜äº‹ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚å‰å›æ›¸ã„ãŸECDSAã®å†…å®¹ã‚‚å‡ºã¦ããŸã®ã§å¾ã€…ã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã«é–¢ã‚ã‚‹å‡¦ç†å†…å®¹ã‚’å’€åš¼ã§ãã¦ã„ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

æœ€å¾Œã¾ã§ãŠèª­ã¿ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚